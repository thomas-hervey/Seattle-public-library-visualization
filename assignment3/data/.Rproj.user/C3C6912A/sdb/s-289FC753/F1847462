{
    "contents" : "---\ntitle: \"lab4\"\nauthor: \"Thomas Hervey\"\ndate: \"2.1.16\"\noutput: html_document\n---\n```{r echo=FALSE}\n# load starting data\nrm(list=ls())\npar(mar=c(1,1,1,1))\ndat = read.csv(\"Food_Security_Indicators_recent_v2.csv\", header=TRUE)\n\nxs = dat[,4:14]\ndiet = xs[,1]\ncereals = xs[,2]\nprotein = xs[,3]\ngdp = xs[,4]\nimports = xs[,5]\nirrigation = xs[,6]\ntrade = xs[,7]\nstability = xs[,8]\nproddvar = xs[,9]\nwater = xs[,10]\nsanitation = xs[,11]\ncolnames(xs) = c(\"diet\", \"cereals\", \"Protein\", \"GDP\", \"imports\", \"irrigation\", \"trade\",\"stability\", \"proddvar\", \"water\", \"sanitation\")\n\nregions = dat[,1]\ncountries = dat[,2]\n\nstuntPercent = dat[,3]\n\n```\n\n_____________________________________________________________\n#SECTION 1: EXPLORE THE DATA\n```{r, echo=TRUE}\n# make scatterplots of predictors\n# describe relationship between predictors\n# which pedictors best isolate high stunting rates?\n\npar(mfrow=c(1,2))\n\nplot(diet,stuntPercent, main=\"Diet as Potential \\nGrowth Stunt Predictor\", xlab=\"Avg dietary energy supply adequacy\", ylab=\"% Children w/ Stunted Growth\")\nplot(cereals,stuntPercent, main=\"Cereals as Potential \\nGrowth Stunt Predictor\", xlab=\"Share of Diet from Cereals\", ylab=\"% Children w/ Stunted Growth\")\n\npar(mfrow=c(1,2))\n\nplot(protein,stuntPercent, main=\"Protein as Potential \\nGrowth Stunt Predictor\", xlab=\"Avg Protein Supply\", ylab=\"% Children w/ Stunted Growth\")\nplot(gdp,stuntPercent, main=\"GDP as Potential \\nGrowth Stunt Predictor\", xlab=\"GDP per capita\", ylab=\"% Children w/ Stunted Growth\")\n\npar(mfrow=c(1,2))\n\nplot(imports,stuntPercent, main=\"Cereal Imports as Potential \\nGrowth Stunt Predictor\", xlab=\"Cereal Import Depedency Ratio\", ylab=\"% Children w/ Stunted Growth\")\nplot(irrigation,stuntPercent, main=\"Irrigation as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of arable land \\nequipped for irrigation\", ylab=\"% Children w/ Stunted Growth\")\n\npar(mfrow=c(1,2))\n\nplot(trade,stuntPercent, main=\"Trade as Potential \\nGrowth Stunt Predictor\", xlab=\"Value of food imports in \\ntotal merchandise exports\", ylab=\"% Children w/ Stunted Growth\")\nplot(stability,stuntPercent, main=\"stability as Potential \\nGrowth Stunt Predictor\", xlab=\"Political Stability and absence \\nof violence/stabilityism\", ylab=\"% Children w/ Stunted Growth\")\n\npar(mfrow=c(1,2))\n\nplot(proddvar,stuntPercent, main=\"Food Prod Var as Potential \\nGrowth Stunt Predictor\", xlab=\"Per capita food \\nprodn variability\", ylab=\"% Children w/ Stunted Growth\")\nplot(water,stuntPercent, main=\"Water as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of Pop with Access to \\nImproved water source\", ylab=\"% Children w/ Stunted Growth\")\n\npar(mfrow=c(1,1))\n\nplot(sanitation,stuntPercent, main=\"Sanitation as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of Pop with Access to \\nImproved sanitation facility\", ylab=\"% Children w/ Stunted Growth\")\n```\n\n###Describe the relationship between predictors\n**Without any of these potential predictors being normalized, we see several different major trends in their respective plots. *Diet* seems to show a negative correlation, with values converging as energy supply adequacy increases. *Cereals* shows a clear positive trend, with more divergence as cereals percentage increases, suggesting that fewer cereals is better. *Protein* could have a negative correlation with a large growth stunting spread around 50-60, decreasing as protein supply increases. *GDP*, besides a few outliers, is a clear indicator that as GDP increases, stunted growth decreases. As *Imports* of cereals dependency ratio becomes positive and increases, there is a negative trend of growth stunting. *Irrigation* corrrelation isn't as straight forward with a large right tail of arible land equipped. There seems to be a wide growth stunting range with land close to 0, and a divergence as arible land equipped increases. *Trade*, besides an outlier, doesn't suggest much of a correlation, with a high amount of data clustered close to 0 GDP per capita. *stability* suggests a negative trend as political stablity reaches and passes 0. Most stunted growth values for all ranges are less than 20%. *Food Prod* variability may have a slightly negative trend with positively skewed outliers included. There is a large clustering between 0 and 20 Per capita food prod variability. *Water* and *Sanitation* both have negative trends, with low stunted growth clustering as access approaches 90-100 percent.**\n\n\n###Which pedictors best isolate high stunting rates?\n**Out of the 11 potential predictor plots, several have extreme outliers that may throw off the trend of the remainder of the data. For example, Cereal imports has a few extreme negative values that may partially level out a line of best fit, when not observing these values, there is a clear negative trend observing values above 0. Once data is normalized, these trends may become more apparent. To pick three, *GDP*, *Water*, and *Sanitation* seem to have the clearest *negative correlation* with stunted growth. This suggests that stunting will decrease as these values increase, with relatively high confidence. On the other hand, the strongest positive correlation seems to be *Cereals*. As we will investigate, these variables are liely not all independent, therefore it can be hypothesized that diet, water, and sanitation should theoretically have inverse relationships with cereals. As now, I believe that all of these previously mentioned variables could be strong predicting indicators.**\n\n\n_____________________________________________________________\n#SECTION 2: NORMALIZE THE STUNTING DATA\n```{r, echo=TRUE}\nlibrary(MASS)\n?fitdistr\n\n## Stunt Percent Normalization Scenarios ##\n\npar(mfrow=c(1,2))\n\n# unnormalized stuntPercent distribution\nhist(stuntPercent, breaks=30, prob=TRUE, xlab= \"Percent Children with Stunted Growth\", main=\"Unnormalized Stunted Growth Distribution\")\ncurve(dnorm(x, mean=mean(stuntPercent), sd=sd(stuntPercent)), col=\"red\", lwd=2, add=TRUE)\n\nqqnorm(stuntPercent, main= \"Unnormalized Stunted Growth Quantile Plot\")\nqqline (stuntPercent, col=\"red\")\n\npar(mfrow=c(1,2))\n\n# stuntPercent gamma distribution normalization\nfitdistr(stuntPercent,\"gamma\")\ngamma_stuntedGrowth_P = pgamma(stuntPercent,1.54028356,0.11125143)\ngamma_stuntedGrowth_Z = qnorm(gamma_stuntedGrowth_P)\nhist(gamma_stuntedGrowth_Z, breaks=30, prob=TRUE, xlab= \"Percent Children with Stunted Growth\", main=\"Gamma Normalized Stunted Growth Distribution\")\ncurve(dnorm(x, mean=mean(gamma_stuntedGrowth_Z), sd=sd(gamma_stuntedGrowth_Z)), col=\"green\", lwd=2, add=TRUE)\n\nqqnorm(gamma_stuntedGrowth_Z, main= \"Gamma Normalized Stunted Growth Quantile Plot\")\nqqline (gamma_stuntedGrowth_Z, col=\"green\")\n\n# stuntPercent log distribution normalization\nfitdistr(stuntPercent,\"lognormal\")\nlognormal_stuntedGrowth_P = plnorm(stuntPercent,2.26944153,0.95420961)\nlognormal_stuntedGrowth_Z = qnorm(lognormal_stuntedGrowth_P)\nhist(lognormal_stuntedGrowth_Z, breaks=30, prob=TRUE, xlab= \"Percent Children with Stunted Growth\", main=\"Log Base Normalized Stunted Growth Distribution\")\ncurve(dnorm(x, mean=mean(lognormal_stuntedGrowth_Z), sd=sd(lognormal_stuntedGrowth_Z)), col=\"blue\", lwd=2, add=TRUE)\n\nqqnorm(lognormal_stuntedGrowth_Z, main= \"Log Base Normalized Stunted Growth Quantile Plot\")\nqqline (lognormal_stuntedGrowth_Z, col=\"blue\")\n\n# stuntPercent ranks distribution normalization\nz_rank_stuntedGrowth=qnorm(rank(stuntPercent)/88)\nhist(z_rank_stuntedGrowth, breaks=30, prob=TRUE, xlab= \"Percent Children with Stunted Growth\", main=\"Ranks Normalized Stunted Growth Distribution\")\ncurve(dnorm(x, mean=mean(z_rank_stuntedGrowth), sd=sd(z_rank_stuntedGrowth)), col=\"purple\", lwd=2, add=TRUE)\n\nqqnorm(z_rank_stuntedGrowth, main= \"Ranks Normalized Stunted Growth Distribution\")\nqqline (z_rank_stuntedGrowth, col=\"purple\")\n\n# evaluate stunted growth normalizations\nshapiro.test(gamma_stuntedGrowth_Z)\nshapiro.test(lognormal_stuntedGrowth_Z)\nshapiro.test(z_rank_stuntedGrowth)\n```\n\n**After exploring the normalizations of the stunting growth data, it's apparent that the z ranks method will produce the best results. This is to be expected in a lot of cases, however, it shouldn't be used all the time. Based on the *shapiro.test* results, the gamma log base normal, and z ranks have respective p-values of 0.1101, 0.0009221, 0.9999. In this case, log base normal is the most significant, suggesting that it is the least normal of our attempted normalizations.**\n\n\n_____________________________________________________________\n#SECTION 3: Explore transforms of the 11 predictor variables\n```{r, echo=TRUE}\n\n## Unnormalized Histograms ##\n\npar(mfrow=c(1,2))\n\n# diet\nhist(diet, prob=TRUE, breaks= 20, main=\"Diet as Potential \\nGrowth Stunt Predictor\", xlab=\"Avg dietary energy supply adequacy\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(diet), sd=sd(diet)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\n\n# cereals\nhist(cereals, prob=TRUE, breaks= 20, main=\"Cereals as Potential \\nGrowth Stunt Predictor\", xlab=\"Share of Diet from Cereals\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(cereals), sd=sd(cereals)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\n\npar(mfrow=c(1,2))\n\n# protein\nhist(protein, prob=TRUE, breaks= 20, main=\"Protein as Potential \\nGrowth Stunt Predictor\", xlab=\"Avg Protein Supply\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(protein), sd=sd(protein)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\n# gdp\nhist(gdp, prob=TRUE, breaks= 20, main=\"GDP as Potential \\nGrowth Stunt Predictor\", xlab=\"GDP per capita\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(gdp), sd=sd(gdp)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\npar(mfrow=c(1,2))\n\n# imports\nhist(imports,breaks= 20, prob=TRUE, main=\"Cereal Imports as Potential \\nGrowth Stunt Predictor\", xlab=\"Cereal Import Depedency Ratio\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(imports), sd=sd(imports)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\n# irrigation\nhist(irrigation, prob=TRUE, breaks= 20, main=\"Irrigation as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of arable land \\nequipped for irrigation\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(irrigation), sd=sd(irrigation)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\npar(mfrow=c(1,2))\n\n# trade\nhist(trade, prob=TRUE, breaks= 20, main=\"Trade as Potential \\nGrowth Stunt Predictor\", xlab=\"Value of food imports in \\ntotal merchandise exports\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(trade), sd=sd(trade)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\n# stability\nhist(stability, prob=TRUE, breaks= 20, main=\"stability as Potential \\nGrowth Stunt Predictor\", xlab=\"Political Stability and absence \\nof violence/stabilityism\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(stability), sd=sd(stability)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\n\npar(mfrow=c(1,2))\n\n# prod var\nhist(proddvar, prob=TRUE, breaks=30, main=\"Food Prod Var as Potential \\nGrowth Stunt Predictor\", xlab=\"Per capita food \\nprodn variability\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(proddvar), sd=sd(proddvar)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\n# water\nhist(water, prob=TRUE, breaks= 20, main=\"Water as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of Pop with Access to \\nImproved water source\", ylab=\"% Children w/ Stunted Growth\")\ncurve(dnorm(x, mean=mean(water), sd=sd(water)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n\npar(mfrow=c(1,2))\n\n# sanitation\nhist(sanitation, prob=TRUE, breaks= 20, main=\"Sanitation as Potential \\nGrowth Stunt Predictor\", xlab=\"Pct of Pop with Access to \\nImproved sanitation facility\", ylab=\"% Children [under 5]\")\ncurve(dnorm(x, mean=mean(sanitation), sd=sd(sanitation)), col=\"red\", lwd=2, add=TRUE, yaxt=\"n\")\n```\n\n**As can be seen by the unnormalized distributions of the potential predictor histograms above, similar to the results from *SECTION 1*, some potential predictors need to be normalized. While some distributions appear to be uniform, including cereals and political stability, others are quite skewed, including proddvar., trade, irrigation. The figures and code below attempt to normalize the unnormal predictors in order to properly conduct a linear regression.**\n\n```{r, echo=TRUE}\n\n## Normalized (Protein, GDP, Trade, Imports, Irrigation, Trade, Proddvar, Sanitation) Histograms ##\n\npar(mfrow=c(1,2))\n\n# normalize \"protein\" by gamma\nfitdistr(protein,\"gamma\")\npgamma_protein = pgamma(protein,23.56960092,0.34492102)\nqnorm_protein = qnorm(pgamma_protein)\nhist(qnorm_protein, breaks=30, main=\"Protein Gamma Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_protein), sd=sd(qnorm_protein)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_protein, main=\"Protein Normalized (gamma)\")\nqqline(qnorm_protein, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# normalize \"GDP\" by lognormal\nfitdistr(gdp,\"lognormal\")\npgamma_gdp = plnorm(gdp,8.54875398,0.98119687)\nqnorm_gdp = qnorm(pgamma_gdp)\nhist(qnorm_gdp, breaks=30, main=\"GDP LogNormal Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_gdp), sd=sd(qnorm_gdp)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_gdp, main=\"GDP Normalized (lognormal)\")\nqqline(qnorm_gdp, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# normalize \"Trade\" by lognormal\nfitdistr(trade,\"lognormal\")\npgamma_trade = plnorm(gdp,8.54875398,0.98119687)\nqnorm_trade = qnorm(pgamma_trade)\nhist(qnorm_trade, breaks=30, main=\"GDP LogNormal Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_trade), sd=sd(qnorm_trade)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_trade, main=\"GDP Normalized (lognormal)\")\nqqline(qnorm_trade, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# normalize \"imports\" by gamma\nnewImports = imports + 160 #shift data so all is positive\nfitdistr(newImports,\"gamma\")\npgamma_imports = pgamma(newImports,12.064609573,0.063092981)\nqnorm_imports = qnorm(pgamma_imports)\nhist(qnorm_imports, breaks=30, main=\"Imports Gamma Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_imports), sd=sd(qnorm_imports)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_imports, main=\"Imports Normalized (gamma)\")\nqqline(qnorm_imports, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# normalize \"irrigation\" by lognormal\nfitdistr(irrigation,\"lognormal\")\npgamma_irrigation = plnorm(irrigation, 2.1917481,  1.8218966)\nqnorm_irrigation = qnorm(pgamma_irrigation)\nhist(qnorm_irrigation, breaks=30, main=\"Irrigation Gamma Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_irrigation), sd=sd(qnorm_irrigation)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_irrigation, main=\"Irrigation Normalized\")\nqqline(qnorm_irrigation, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# normalize \"proddvar\" by gamma\nfitdistr(proddvar,\"lognormal\")\npgamma_proddvar = plnorm(proddvar,2.04240232,0.78329059)\nqnorm_proddvar = qnorm(pgamma_proddvar)\nhist(qnorm_proddvar, breaks=30, main=\"Proddvar Gamma Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_proddvar), sd=sd(qnorm_proddvar)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_proddvar, main=\"Proddvar Normalized (gamma)\")\nqqline(qnorm_proddvar, col=\"blue\")\nshapiro.test(qnorm_proddvar)\n\npar(mfrow=c(1,2))\n\n# normalize \"sanitation\" by gamma\nfitdistr(sanitation,\"gamma\")\npgamma_sanitation = pgamma(water,2.804958794,0.047747757)\nqnorm_sanitation = qnorm(pgamma_sanitation)\nhist(qnorm_sanitation, breaks=30, main=\"Sanitation Gamma Distribution\", prob=TRUE)\ncurve(dnorm(x, mean=mean(qnorm_sanitation), sd=sd(qnorm_sanitation)), col=\"blue\", lwd=2, add=TRUE, yaxt=\"n\")\nqqnorm(qnorm_sanitation, main=\"Sanitation Normalized (gamma)\")\nqqline(qnorm_sanitation, col=\"blue\")\n\npar(mfrow=c(1,2))\n\n# shaprio-wilkes test\nshapiro.test(diet)\nshapiro.test(cereals)\nshapiro.test(qnorm_trade)\nshapiro.test(stability)\nshapiro.test(qnorm_protein)\nshapiro.test(qnorm_gdp)\nshapiro.test(qnorm_imports)\nshapiro.test(qnorm_irrigation)\nshapiro.test(qnorm_proddvar)\nshapiro.test(water)\nshapiro.test(qnorm_sanitation)\n\n \nqnorm_xs = data.frame(diet, cereals, qnorm_protein, qnorm_gdp, qnorm_irrigation, trade, stability, sanitation)\nsummary(lm(gamma_stuntedGrowth_Z~.,dat=qnorm_xs))\n```\n\n**The above code attempts to normalize several variables including protein, GDP, irrigation, imports, proddvar, water and sanitaiton. Based on the previous histograms, these distributions were not normal and needed to be noramlized in order to begin comparion between variables. With the exception of normalizing GDP by the lognormal distribution, every other variable was normalized by gamma. This is because, they often had distributions that were  skewed in one direction, but were often at least bimodal. GDP clearly has an inverse log relationship, suggesting that the lognormal fitdistr would be best to normalize. I predict that several of these predictors will be thrown out of the regression anyways due to high correlation. This will be explored in the following steps.**\n\n\n**This is a good project because, while I do have time constraints, I fully understand the power of exploratory analysis. This is what a lot of my thesis work will entail. After observing correlations and testing with the new dataset, I have decidded not to include a few of the normalizations (including water and sanitation), as well as removed some variables entirely (including water). This gives me an R-squared value of 0.6305. This is a good starting point before looking further into correlations as well as interactions.**\n\n\n_____________________________________________________________\n#SECTION 4: Print and discuss correlations between the predictors and variables\n```{r echo=TRUE}\nround(cor(stuntPercent,xs),2) # check correlation between original data & stunt\nround(cor(xs),2) # check correlation within original data\nround(cor(qnorm_xs),2) # check correlation within normalized data\n```\n\n\n**As seen in the original scatterplots and mentioned in *SECTION 1*, almost every distribution had a negative slope. Therefore we should expect the correlation between each predictor variable and stunt percent to be negative. With the exception of cereals (0.63) and trade (0.2), all correlation coefficients were less than zero. The largest being sanitation (-0.63), and water (-0.54).**\n\n\n**After running *round(cor(xs),2)* checking the correlation between predictor variables alone, there are several things that stick out immediately. While expected, diet and protein have a correlation of 0.75, GDP and sanitation have a correlation of 0.63, and water and sanitation have a correlation of 0.71. This is good information, because studing this table could help determine what variables to throw out due to high correlation where one could easily represent the others. Low correlations are valuable becuase keeping one of two highly correlated in the model (water instead of both water and sanitaiton for example), and adding variables that are lowly correlated with water and have generally low correlation with other variables (for example: imports has a correlation of -0.1), will likely produce a strong model.**\n\n\n**When observing my normalized dataset by running *round(cor(qnorm_xs),2)*, previous correlations tended to become stronger. For example, the correlation between cereals and GDP is now -0.60 instead of -0.51 previously. A few new fairly high correlatiosn immerge including irrigation and sanitation (0.58), and water and cereals (0.53). As always, there may be a few points that are significant and/or outliers pulling the data (ie. Djibouti's trade). None the less, this is all valuable information that will be applied when creating our final model.**\n\n\n_____________________________________________________________\n#SECTION 5: Run lm() on all predictors\n```{r}\n\n# # linear model of original data\n# m = lm(stuntPercent~. , dat=xs)\n# summary(m)\n# plot(m)\n\n# # linear model of normalized data\n# n = lm(gamma_stuntedGrowth_Z~. , dat=qnorm_xs)\n# summary(n)\n# plot(n)\n\n\ntrade[5] = 190 # hack fix to get djibouti 'out'\nqnorm_xs3 = data.frame(diet, cereals, qnorm_protein, qnorm_gdp, qnorm_irrigation, imports, trade, stability, proddvar, water, sanitation)\n\n# linear model of normalized data w/o djibouti\no = lm(gamma_stuntedGrowth_Z~. , dat=qnorm_xs3)\nsummary(o)\nplot(o)\n```\n\n\n**By running the code above, I can investigate the summaries of both the original and normalized data. Without observing any of the normalized data, several significant values are present including cereals, imports, trade, stability, and sanitation with respective p-values of 0.00537, 0.02130, 0.00520, 0.00244, 0.00580. Initially, without normalizing, these predictors seem to be most useful. When thinking about it, some of the other predictors with high values are likely correlated, such as diet and protein with cereals, and water with sanitation. In most cases, for example, one could expect that an individual consuming high cereal amounts probably have a strong negative relationship with protein. In addition, the bottom linear model plot has an adjusted trade value for Djibouti, since it is significantly higher than every other data point, and is pulling leverage up substantially.**\n\n\n**Since I plan on working with the normalized data from here on out, I will discuss this in more detail. Within this summary, it appears that protein (Pr(>|t|) = 0.38682), gdp (Pr(>|t|) = 0.77466), irrigation (Pr(>|t|) = 0.35717), and proddvar (Pr(>|t|) = 0.58342) are the least useful. I was surprised because I would have figured that irrigation would be highly correlated to water and sanitation and that possiblyirrigation would be better predictors than water or sanitation. I thought this would expecially be the case because both water and sanitation were normalized as well. I was also surprised that protein wasn't lower.**\n\n\n**Besides this, I thought that most of the significant values make sense, especially the cereals, water and sanitation. While, based on prior knowledge about economics and political sustainability, I thought that stability and trade would have higher p-values (and other concrete variables would actually be affecting these rather than the other way around). But, since there aren't any other variables that measure this directly, these highly significant values make sense. In this case, diet is only 0.22280 and cereals is only 0.00168, trade is 0.11735, stability is 0.01233, and sanitation is 0.00556. After observing interactions, what the summary suggested will likely be in my final model.**\n\n\n_____________________________________________________________\n#SECTION 6: Explore interactions between the predictor terms\n```{r}\n\n#summary(lm(gamma_stuntedGrowth_Z~.,dat=qnorm_xs3))\n#summary(lm(gamma_stuntedGrowth_Z~cereals+trade+stability+sanitation,dat=qnorm_xs3))\n#summary(lm(gamma_stuntedGrowth_Z~cereals*trade*stability*sanitation,dat=qnorm_xs3))\n\nqnorm_xs3[\"region\"] = regions\nsummary(lm(gamma_stuntedGrowth_Z~cereals+trade+stability+sanitation+cereals:sanitation+regions,dat=qnorm_xs3)) #this one\n\n# summary(lm(gamma_stuntedGrowth_Z~trade+stability+sanitation+cereals:sanitation,dat=qnorm_xs2))\n#summary(lm(stuntPercent~sanitation,dat=xs))\n```\n\n\n**After playing with some interactions, it was clear that some significantly important factors will need to be paired with one or two interaction variables. Based on the significant p-value results from the last section, after running a linear model (with primarily the '*' operator) to observe interactions between cereals, stability, trade, imports, and sanitation, there were some interesting results. The p-values tended to have a wide range in values, from close to .9 to .0001. Ultimately, I decided to include the interaction between cereals and sanitation. With both variables being strong indicators and inversely related, it was worth exploring. During testing of interactions, I also found several important characteristics, like how water correlated too frequently with sanitation and usually produced a higher R-squared value once removed.**\n\n\n**Up until this point, I have neglected to use geographic features (regions), for any sort of analysis. As suggested in class and intuitively, regions should be a strong indicator. Once this was included, I produced a model with an R-squared value = 0.7663. Since other interactions produced less reliable results (please see below), I decided on the final variables for my model.**\n\nFrom one interactions test, the following p-values were produced:\n**[ sanitation (0.219), stability:imports (0.205), stability:trade:imports (0.155), stability:imports:water (0.178), cereals:stability:trade:imports (0.184), stability:trade:imports:water (0.140), cereals:stability:trade:imports:water (0.171), and stability:trade:imports:water:sanitation (0.208) ]**\n\n\n_____________________________________________________________\n#SECTION 7: Build your best regression model\n```{r echo=TRUE}\nfinal = lm(gamma_stuntedGrowth_Z~cereals+trade+stability+sanitation+cereals:sanitation+regions,dat=qnorm_xs3)\nsummary(final)\nplot(final)\n```\n\n\n**The code above produces an R-squared value of 0.7663, the best out of any combinations that I could produce. Clearly, it has exempt many original variables, and introduced a few new ones including an interaction. This model has the following characteristics:**\n**-a gamma normalization of our 'y' stunting data (the best normalization produced out of section 2)**\n**-two highly significant regions (regionsSouthern Asia : 2.14e-05 | regionsSouth-Eastern Asia : 3.37e-05)**\n**-Significant p-value = 2.2e-16**\n\n\n**Based on the plots, the residual leverage coule be imporved, with, what appears to be Djibouti, still pulling the leverage positive. The residual vs fitted follows pretty closely with our 0.0 line, the normal Q-Q plot does a good job fitting to the majority of the data (while the tails could still use some more work, ie. point 66, puls the data positively on the right tail), and the majority of residuals vs leverage line does a decent job hovering just above 0.**\n\n\n**In addition to these choices of potential predictors, I justify leaving out other variables, such as porddvar and gdp because of their very high correlation with other predictors. Water was too related to sanitation, and protein and diet were too strong with cereals, but had less impact.**\n\n\n_____________________________________________________________\n#SECTION 8: Use linear algebra to estimate your own regression coefficients\n\n```{r echo=TRUE}\nx = cov(qnorm_xs, qnorm_xs)\ncov(stuntPercent, qnorm_xs)\nginv(t(x)%*%x)\n#summary(lm(qnorm_xs))\n```\n\n**After attempting to explore coefficient estimation, I believe that my results aren't very reliable. As can be seen by the initial *cov* chart produced, some values are high, because some variables like diet have not been normalized. However, if we are to assume that this is correct, many of the coefficients make sense. For example, it makes sense that diet and protein are inverse signs from cereals. The scaling factor also makes sense. In addition, when diet is high, so too is sanitation. This information however isn't completely reliable becuase I do not fully understand if my results are correct. When running ginv(), the predictor values aren't what I would expect, but I believe that I am on the right track. When summarizing the initial *qnorm_sx* and observing *Estimate*, I am receiving the same signs and scale factors between indicators. This is something that needs to be further explroed in following classes.**",
    "created" : 1458055839414.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "468328088",
    "id" : "F1847462",
    "lastKnownWriteTime" : 1454536425,
    "path" : "~/Projects/education/academic/GEOG210B/lab4/lab4.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_markdown"
}